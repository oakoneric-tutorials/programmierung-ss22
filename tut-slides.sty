\ProvidesPackage{tut-slides}

\usetheme[titleformat=allcaps]{metropolis}
%\useoutertheme{TUD}
\useinnertheme{tud}
%\usefonttheme{metropolis}
\usecolortheme{tud}

\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
%\useoutertheme{frankfurt}

\RequirePackage{tikz}
\usetikzlibrary{calc}
\usepackage{tudscrcolor}

%\renewcommand{\metropolis@colors@dark}{
%	\setbeamercolor{normal text}{%
%		fg=black!2,
%		bg=cddarkblue
%	}
%	\usebeamercolor[fg]{normal text}
%}
%\renewcommand{\metropolis@colors@light}{
%	\setbeamercolor{normal text}{%
%		fg=cddarkblue,
%		bg=black!2
%	}
%}


%\setbeamercolor{progress bar}{fg= blue , bg= blue}
\setbeamercolor{title separator}{ fg= orange , bg= blue }
%\setbeamercolor{progress bar in section page}{ fg= yellow , bg= blue }
%\setbeamercolor{normal text}{fg = cddarkblue bg=cddarkblue}
%\setbeamercolor{normal text}{bg=cddarkblue}
%\setbeamercolor{background canvas}{bg=cddarkblue}
%\metroset{background=light}
\setbeamercolor{normal text}{fg = white, bg = white}

\usepackage[scale=1, default]{opensans}
\newcommand*{\osfamily}{\fontfamily{fos}\selectfont}
\DeclareTextFontCommand{\textos}{\osfamily}
%\usepackage[sfdefault]{FiraSans}

\setbeamertemplate{itemize item}{\raisebox{1.5pt}{\scalebox{.8}{$\blacktriangleright$}}}
\setbeamertemplate{itemize subitem}{$\vartriangleright$}
\setbeamertemplate{itemize subsubitem}{--}

%\defbeamertemplate*{title page}{customized}[1][]
%{
%	\usebeamerfont{title}\inserttitle\par
%	\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}Uebung: \insertsubtitle\par
%	\bigskip
%	\usebeamerfont{author}\insertauthor\par
%	\usebeamerfont{institute}\insertinstitute\par
%	\usebeamerfont{date}\insertdate\par
%	\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic
%%	\setbeamercolor{background canvas}{blue}
%}

\defbeamertemplate{frametitle}{pride}[1][]
{
		\setbeamercolor{frametitle}{fg=cddarkblue, bg=cddarkblue}
		\begin{tikzpicture}[remember picture, overlay]
			\fill[shading=rainbow,shading angle=270] ($(current page.north west)$) rectangle ($(current page.north east) - (0,0.4em)$);
			\shade[shading=rainbow,shading angle=270, opacity=0.4] ($(current page.north west)$) rectangle +(\paperwidth, -2.4em);
			\node[anchor=west, font=\usebeamerfont{frametitle}\color{cddarkblue}] at ($(current page.north west) + (0.5em,-1.4em)$) {\MakeUppercase{\insertframetitle}};
		\end{tikzpicture}
		\begin{tikzpicture}
			\path[draw=none, line width=2pt, color=black] ($(current page.north west) - (0, 1em) $) -- +(\linewidth, 0);
		\end{tikzpicture}		
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                     SET COLOURS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AtBeginDocument{\colorlet{defaultcolor}{.}}

\setbeamercolor{normal text}{%
	fg=cddarkblue,
	bg=black!2
}

\setbeamercolor{block body}{use=normal text,fg=normal text.fg,bg=cddarkblue!10}
%\setbeamercolor{block title}{fg=tudaccent6,bg=tudbase 20}
\setbeamercolor{block title}{fg=white,bg=cddarkblue}

\setbeamercolor{alerted text}{fg=cdorange}
\setbeamercolor{block body alerted}{use=normal text,fg=normal text.fg,bg=cdorange!10}
\setbeamercolor{block title alerted}{fg=white, bg=cdorange}

\setbeamercolor{example text}{fg=cddarkblue}
\setbeamercolor{block body example}{use=normal text, fg=normal text.fg,bg=cdgray!10}
\setbeamercolor{block title example}{fg=white,bg=cdgray}

\setbeamercolor{frametitle}{fg = white, bg = cddarkblue}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                    NEW TITLEPAGE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{datetime}
\renewcommand{\dateseparator}{.}

%%%%%% Neugestaltung des Titelblattes ---- ANFANG
\setbeamertemplate{title page}{
	\begin{minipage}[t][0.1\paperheight]{\dimexpr0.5\linewidth-\fboxrule-\fboxsep}
		\ifx\inserttitlegraphic\@empty\else\usebeamertemplate*{title graphic}\fi
	\end{minipage}
	\begin{minipage}[b][0.9\paperheight]{\textwidth}
		\ifx\inserttitle\@empty\else\usebeamertemplate*{title}\fi
		\ifx\insertsubtitle\@empty\else\usebeamertemplate*{subtitle}\fi
		\usebeamertemplate*{title separator}
		\ifx\beamer@shortauthor\@empty\else\usebeamertemplate*{author}\fi
		\vspace{1cm}
		\ifx\insertdate\@empty\else\usebeamertemplate*{date}\fi
		\ifx\insertinstitute\@empty\else\usebeamertemplate*{institute}\fi
		\vfill
		\vspace*{1mm}
	\end{minipage}
	\begin{tikzpicture}[remember picture, overlay]
		\node [
		fill=none,  % Farbe des Randstreifens
		text=bg,  % Textfarbe
		font=\fosfamily\tiny,  % Einstellungen für die Schrift
%		inner xsep=0,       % Abstand des Textes von unten
		% maximale Textbreite = Papierhöhe - 2*Abstand des Textes von unten:
		%			text width={\dimexpr\paperheight-2\footskip\relax},
%		align=center,
		%			minimum height=8mm,% Breite des Randstreifens
		anchor=south east,
		] at ($(current page.south east)+(-3mm,+3mm)$)
		{\parbox{2cm}{\raggedleft letzte Änderung: \\ \ddmmyyyydate\today , \currenttime}};
%		\draw[draw, line width=2pt, color=cdorange] ($(current page.north west)+(+1mm,0)$) -- ($(current page.south west)+(+1mm,0)$);
	\end{tikzpicture}
}

\setbeamertemplate{title graphic}{
	\vbox to 0pt {
		\vspace*{2em}
		\inserttitlegraphic%
	}%
	\nointerlineskip%
}
\setbeamertemplate{title}{
	\raggedright%
	\vspace{2.5cm}
	\linespread{1.0}%
	\inserttitle%
	\par%
	\vspace*{0.5em}
}
\setbeamertemplate{subtitle}{
	\raggedright%
	\insertsubtitle%
	\par%
%	\vspace*{0.5em}
}

\makeatletter
%\newlength{\metropolis@titleseparator@linewidth}
\setlength{\metropolis@titleseparator@linewidth}{0.8pt}
\setbeamertemplate{title separator}{
	\begin{tikzpicture}
	\fill[fg] (0,0) rectangle (\textwidth, \metropolis@titleseparator@linewidth);
	\end{tikzpicture}%
	\par%
}
\makeatother
\setbeamertemplate{author}{
	\vspace*{2em}
	\insertauthor \\%
	\insertemail
	\par%
	\vspace*{0.25em}
}
\setbeamertemplate{date}{
	\scriptsize \insertcity, \insertdate%
	\par%
}
\setbeamertemplate{institute}{
%	\vspace*{3mm}
%	\vfill
%	\hfill
	\insertinstitute
	\par%
}


\def\titlepage{%
	\usebeamertemplate{title page}
}


\makeatletter
\def\maketitle{%
	\ifbeamer@inframe
		\titlepage
	\else%
		\setbeamercolor{normal text}{fg=black!2   ,	bg=cddarkblue}
		\frame[plain,noframenumbering]{\titlepage}%
		\setbeamercolor{normal text}{fg=cddarkblue,	bg=black!2}
		
	\fi%
}
\makeatother
%%%%%% Neugestaltung des Titelblattes ---- ENDE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand*{\changeemail}{}
\newcommand*{\email}[1]{\renewcommand*{\changeemail}{#1}}
\newcommand{\insertemail}{\url{\changeemail}}

\newcommand*{\changecity}{}
\newcommand*{\city}[1]{\renewcommand*{\changecity}{#1}}
\newcommand{\insertcity}{\changecity}
